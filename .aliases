#!/bin/sh

# Command shortcut
alias a='ag'
alias b='cd ../'
alias c='cd'
alias d='docker'
alias e='emacs'
alias f='nautilus &' # finder
alias g='git'
alias h='history'
alias i="ifconfig"
alias j='gwaei &' # dictionary jisho
alias k='mkdir -p'
alias l='LC_COLLATE=C ls -al --color=auto --human-readable --group-directories-first'
alias m='mocp' # music on console
# alias n='' # to use npm n module
alias o='xdg-open'
alias p='pet'
alias q='exit'
alias r='ranger' # finder
alias s='chromium-browser --app="https://google.com/"' # search
alias t='tasksh' # cui for task
alias u='du -hs' # directory size
alias v='vim' # nvim
alias w='w'
alias x='ex'
alias y='yes'
alias z='zsh'

# Others
alias copy='echo ${PWD} | xsel -b'

if [[ $0 != "bash" ]]; then
  # Global aliases
  alias -g G='| grep --color'
  alias -g L='| less'
  alias -g H='| head'
  alias -g T='| tail'
  alias -g P='| peco'

  # Suffix aliases
  alias -s rb='ruby'
  alias -s py='python3'
  alias -s go='go'
  alias -s java='java'
  alias -s js='node'
  alias -s hs='ghci'
  alias -s {png,jpg,bmp,PNG,JPG,BMP}='feh'
  alias -s mp3='mplayer'
  alias -s html='chromium-browser'
  alias -s {gz,tgz,zip,lzh,bz2,tbz,Z,tar,arj,xz}='extract'
  alias -s deb='sudo gdebi' # dpkg -i だと依存関係解決してくれないため
fi

# permission
alias 644='chmod 644'
alias 755='chmod 755'
alias 777='chmod 777'

# typo
alias gl='g l'
alias gs='g s'
alias ll='l'

# Color
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'
alias less='less -R'
alias gitwatch='fswatch -0 . | xargs -0 -n 1 sh -c "clear && git status --short"' # to need to install fswatch

# sysctrl
alias reboot='reboot'
alias shutdown='reboot'
alias suspend='systemctl suspend'
alias lock='i3lock -c 000000'

show() {
  case $1 in
    group) cat /etc/group;;
    kernel) uname -a;;
    os) cat /etc/lsb-release;;
    spec) neofetch;;
    *) echo 'worng subcommand found';;
  esac
}

pet() {
  case $1 in
    n)
      shift
      command pet new "$@";;
    ls)
      shift
      command pet list "$@";;
    e)
      shift
      command pet edit "$@";;
    x) # need to instal peco
      shift
      command pet exec "$@";;
    *) command pet "$@";;
  esac
}

# VirtualBox
alias vbm='vboxmanage'
alias vbh='vboxheadless'
vbox() {
  case $1 in
    ls)
      echo "[all]"
      command vboxmanage list vms
      echo "[running]"
      command vboxmanage list runningvms;;
    save) # save state
      shift
      command vboxmanage controlvm $1 savestate;;
    start) # detachable start
      shift
      command vboxmanage startvm --type separate $1;;
    *) command vboxmanage "$@";;
  esac
}

# Vagrant
alias vg='vagrant'
vagrant() {
  case $1 in
    i) command vagrant init;;
    u) command vagrant up;;
    s) command vagrant status;;
    push) command vagrant snapshot push;;
    pop) command vagrant snapshot pop;;
    h) command vagrant ssh;;
    l) command vagrant reload;;
    *) command vagrant "$@";;
  esac
}

# docker subcommand aliases
docker() {
  case $1 in
    ps)
      shift
      command docker ps "$@";; # -a
    i)
      shift
      command docker images "$@";;
    v)
      shift
      command docker volume "$@";;
    b) docker build -t ${1:-dot} $HOME/dotfiles/. ;;
    r)
      WS_DIR="${HOME}/workspace"
      mkdir -p $WS_DIR # NOTE: need to make share directory in host before using cmd below coz its owner will be root.
      CONTAINER_ID=$(docker run -it -d --name $1 -v $WS_DIR:$WS_DIR ${2:-dot});;
      # docker attach --sig-proxy=false --detach-keys "ctrl-\\" $CONTAINER_ID;;
    c)
      NEW_TAG=$(docker images | awk -v img_name="${2:-dot}" '($1 == img_name) {print $2 += .01; exit}')
      docker commit ${1:-app} ${2:-dot}:$NEW_TAG;;
    a) docker attach --sig-proxy=false --detach-keys "ctrl-\\" $1;;
    s)
      shift
      docker start $1 "$@";;
    p)
      shift
      docker stop $1 "$@";;
    x)
      docker exec -it $1 bash;;
    rmc-all) docker rm $(docker ps --all --quiet) -f;;
    rmi-all) docker rmi $(docker images --quiet) -f;;
    rmv-all) docker volume rm `docker volume ls -q -f dangling=true`;;
    *) command docker "$@";;
  esac
}

# NOTE: bash and zsh allows to use hyphens but POSIX
alias dc="docker-compose"
docker-compose() {
  case $1 in
    i)
      shift
      command docker-compose images "$@";;
    b)
      shift
      command docker-compose up -d --build "$@";;
    *) command docker-compose "$@";;
  esac
}

# mac sshfs
# alias blogfs='sshfs blog: ~/mp/blog -oauto_cache,reconnect,defer_permissions,negative_vncache,noappledouble,volname=blog'
# alias kaishafs='sshfs kaisha: ~/mp/kaisha -oauto_cache,reconnect,defer_permissions,negative_vncache,noappledouble,volname=kaisha'

extract() {
  case $1 in
    *.tar.gz|*.tgz) tar xzvf $1;;
    *.tar.xz) tar Jxvf $1;;
    *.zip) unzip $1;;
    *.lzh) lha e $1;;
    *.tar.bz2|*.tbz) tar xjvf $1;;
    *.tar.Z) tar zxvf $1;;
    *.gz) gzip -d $1;;
    *.bz2) bzip2 -dc $1;;
    *.Z) uncompress $1;;
    *.tar) tar xvf $1;;
    *.arj) unarj $1;;
  esac
}
